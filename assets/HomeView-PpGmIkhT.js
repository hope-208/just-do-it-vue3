import{d as K,_ as E,s as C,o as n,c as k,w as i,a as D,t as p,b as o,e as c,f as y,g as v,F as w,r as F,E as H,h as P,i as L,j as S,k as U,l as q,m as j,n as B,p as Q,q as z,u as W,v as N,x as R,y as X,z as Z,A as $}from"./index-CNo6doTj.js";/* empty css                */const x=K({id:"tasksItemsStore",state:()=>({tasksItems:[{title:"Разработать минимальный набор для менеджера задач",description:"Функционал: добавление, удаление, получение списка задач, получение одной записи, изменение записи. Запись должна состоять из следующих полей: заголовок, описание, время создания, время изменения, маркер выполнения.",categoryId:0,editableTitle:!1,editableDesc:!1,priority:1,date:"",createAt:"18.05.2024 19:31",updateAt:[],isDone:!0},{title:"Тестовая задача",description:"Создана для наполнения.",categoryId:0,editableTitle:!1,editableDesc:!1,priority:2,date:"05.05.2024",createAt:"18.05.2024 19:31",updateAt:[],isDone:!1},{title:"Доработать проект",description:"Добавить группировку задач по категориям, возможность добавления подзадач, расстановки приоритетов.",categoryId:1,editableTitle:!1,editableDesc:!1,priority:3,date:"",createAt:"18.05.2024 19:32",updateAt:[],isDone:!1}],newItem:{title:"",description:"",categoryId:null,editableTitle:!1,editableDesc:!1,priority:3,date:"",createAt:"",updateAt:[],isDone:!1},editItem:{},activeModalValue:{},isOpenModalLook:!1,isOpenModalEdit:!1,titleModal:"",btnModal:"",activeId:null,action:"",historyAction:{},searchTaskParams:"",filteredTaskItems:[]}),actions:{statusEditableTitle(e,t){var l;if(t!==""){if(t&&this.tasksItems[e].title!==t){let s={};this.tasksItems[e].title=t,s.upTitle=`Задача переименована
    из "${this.tasksItems[e].description}" в "${t}".`,this.historyAction.id=(l=this.tasksItems[e].updateAt)==null?void 0:l.length,this.historyAction.dateChange=this.getNow(),this.historyAction.actions=s,this.tasksItems[e].updateAt.push(this.historyAction),this.historyAction={},s={}}this.tasksItems[e].editableTitle=!this.tasksItems[e].editableTitle,this.filteredTask(this.searchTaskParams)}},statusEditableDesc(e,t){var l;if(t!==""){if(t&&this.tasksItems[e].description!==t){let s={};this.tasksItems[e].description=t,s.upDescription=`Описание задачи переименовано
    из "${this.tasksItems[e].description}" в "${t}".`,this.historyAction.id=(l=this.tasksItems[e].updateAt)==null?void 0:l.length,this.historyAction.dateChange=this.getNow(),this.historyAction.actions=s,this.tasksItems[e].updateAt.push(this.historyAction),this.historyAction={},s={}}this.tasksItems[e].editableDesc=!this.tasksItems[e].editableDesc,this.filteredTask(this.searchTaskParams)}},statusDone(e){var l;let t={};return this.tasksItems[e].isDone?t.upIsDone="Задача отмечена как невыполненная.":t.upIsDone="Задача отмечена как выполненная.",this.historyAction.id=(l=this.tasksItems[e].updateAt)==null?void 0:l.length,this.historyAction.dateChange=this.getNow(),this.historyAction.actions=t,this.tasksItems[e].updateAt.push(this.historyAction),this.historyAction={},t={},!this.tasksItems[e].isDone},openModal(e,t){this.action=e,e=="add"?(this.isOpenModalEdit=!0,this.activeId=this.tasksItems.length,this.titleModal="Добавить задачу",this.btnModal="Добавить",this.newItem.categoryId=0,this.activeModalValue=this.newItem):e=="edit"?(this.isOpenModalEdit=!0,this.titleModal="Редактировать задачу",this.btnModal="Сохранить",this.activeId=t,this.editItem=this.tasksItems[t],this.activeModalValue=this.editItem):(this.titleModal="Просмотр задачи",this.btnModal="Редактировать",this.activeId=t,this.isOpenModalLook=!0)},getNow(){let e=new Date,t;e.getDate()<10?t="0"+e.getDate():t=e.getDate();let l;e.getMonth()+1<10?l="0"+(e.getMonth()+1):l=e.getMonth()+1;let s=e.getFullYear(),a;e.getHours()<10?a="0"+e.getHours():a=e.getHours();let d;return e.getMinutes()<10?d="0"+e.getMinutes():d=e.getMinutes(),`${t}.${l}.${s} ${a}:${d}`},historyChanges(e){var l;let t={};this.activeModalValue.title!==e.title&&(t.upTitle=`Задача переименована
   из "${this.activeModalValue.title}" в "${e.title}".`),this.activeModalValue.description!==e.description&&(this.activeModalValue.description==""?t.upDescription=`Добавлено описание задачи "${e.description}".`:t.upDescription=`Описание задачи переименовано из "${this.activeModalValue.description}" в "${e.description}".`),this.activeModalValue.categoryId!==e.categoryId&&(t.categoryId=`Категория задачи изменена с "${this.activeModalValue.categoryId}" на "${e.categoryId}".`),this.activeModalValue.priority!==e.priority&&(t.upPriority=`Приоритет задачи изменен с "${this.activeModalValue.priority}" на "${e.priority}".`),this.activeModalValue.date!==e.date&&(this.activeModalValue.date==""?t.upDate=`К задаче добавлен дедлайн "${e.date}".`:t.upDate=`Дедлайн задачи изменена с "${this.activeModalValue.date}" на "${e.date}".`),this.activeModalValue.isDone!==e.isDone&&(this.activeModalValue.isDone?t.upIsDone="Задача отмечена как невыполненная.":t.upIsDone="Задача отмечена как выполненная."),this.historyAction&&(this.historyAction.id=(l=this.activeModalValue.updateAt)==null?void 0:l.length,this.historyAction.dateChange=this.getNow(),this.historyAction.actions=t)},saveModalData(e){e.title!==""&&e.description!==""&&(this.activeModalValue.title=e.title,this.activeModalValue.description=e.description,this.action=="add"&&(this.activeModalValue.createAt=this.getNow(),this.tasksItems.push(this.activeModalValue),this.closeModal(),this.filteredTask(this.searchTaskParams)))},closeModal(){this.isOpenModalLook=!1,this.isOpenModalEdit=!1,this.titleModal="",this.btnModal="",this.newItem={id:null,title:"",description:"",categoryId:null,editableTitle:!1,editableDesc:!1,priority:3,date:"",createAt:"",updateAt:[],isDone:!1},this.editItem={},this.activeModalValue={},this.historyAction={},this.activeId=null,this.action=""},deleteTask(e){this.tasksItems.splice(e,1),this.filteredTask(this.searchTaskParams)},filteredTask(e){this.searchTaskParams=e,this.filteredTaskItems=[];for(let t=0;t<this.tasksItems.length;t++)(this.tasksItems[t].title.includes(e)||this.tasksItems[t].description.includes(e))&&this.filteredTaskItems.push(this.tasksItems[t]);return this.filteredTaskItems}}}),tt={name:"LookModalTask",props:["modalValue"],setup(){const e=x(),{isOpenModalLook:t,titleModal:l,tasksItems:s,activeId:a}=C(e),{closeModal:d}=e;return{isOpenModalLook:t,titleModal:l,tasksItems:s,activeId:a,closeModal:d}},data(){return{isOpenHistory:!1}},methods:{visibleOpenHistory(){this.isOpenHistory=!this.isOpenHistory}}},et={class:"my-header"},st={class:"header-popup"},it={key:1};function ot(e,t,l,s,a,d){const r=H,f=P,M=L,g=S;return n(),k(g,{modelValue:s.isOpenModalLook,"onUpdate:modelValue":t[0]||(t[0]=_=>s.isOpenModalLook=_),width:"50%",onClose:t[1]||(t[1]=_=>(s.closeModal,d.visibleOpenHistory()))},{header:i(()=>[D("div",et,[D("h4",st,p(s.titleModal),1)])]),default:i(()=>{var _,u,T;return[o(f,null,{default:i(()=>[o(r,{span:4,style:{"font-weight":"600"}},{default:i(()=>[c("Название:")]),_:1}),o(r,{span:20},{default:i(()=>{var m;return[c(p((m=s.tasksItems[s.activeId])==null?void 0:m.title),1)]}),_:1})]),_:1}),o(f,null,{default:i(()=>[o(r,{span:4,style:{"font-weight":"600"}},{default:i(()=>[c("Описание:")]),_:1}),o(r,{span:20},{default:i(()=>{var m;return[c(p((m=s.tasksItems[s.activeId])==null?void 0:m.description),1)]}),_:1})]),_:1}),o(f,null,{default:i(()=>[o(r,{span:4,style:{"font-weight":"600"}},{default:i(()=>[c("Создано:")]),_:1}),o(r,{span:20},{default:i(()=>{var m;return[c(p((m=s.tasksItems[s.activeId])==null?void 0:m.createAt),1)]}),_:1})]),_:1}),(_=s.tasksItems[s.activeId])!=null&&_.updateAt.length?(n(),k(f,{key:0},{default:i(()=>[o(M,{type:"primary",icon:"ArrowDown",onClick:d.visibleOpenHistory,style:{"margin-left":"auto"}},{default:i(()=>[c(" Журнал изменений")]),_:1},8,["onClick"])]),_:1})):y("",!0),(u=s.tasksItems[s.activeId])!=null&&u.updateAt.length&&a.isOpenHistory?(n(),v("div",it,[o(f,null,{default:i(()=>[o(r,{span:4,style:{"font-weight":"600"}},{default:i(()=>[c("Дата")]),_:1}),o(r,{span:20,style:{"font-weight":"600"}},{default:i(()=>[c("Действия")]),_:1})]),_:1}),(n(!0),v(w,null,F((T=s.tasksItems[s.activeId])==null?void 0:T.updateAt,m=>(n(),k(f,{key:m},{default:i(()=>[o(r,{span:4},{default:i(()=>[c(p(m.dateChange),1)]),_:2},1024),o(r,{span:20},{default:i(()=>[(n(!0),v(w,null,F(m.actions,V=>(n(),k(f,{key:V},{default:i(()=>[c("— "+p(V),1)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024))),128))])):y("",!0)]}),_:1},8,["modelValue"])}const Y=E(tt,[["render",ot]]),lt={name:"AddModalTask",data(){return{taskForm:{title:"",description:""},rulesTask:{title:[{required:!0,message:"Название задачи не может быть пустым.",trigger:"blur"}],description:[{required:!0,message:"Описание задачи не может быть пустым.",trigger:"blur"}]}}},setup(){const e=x(),{isOpenModalEdit:t,titleModal:l,btnModal:s}=C(e),{closeModal:a,saveModalData:d}=e;return{isOpenModalEdit:t,titleModal:l,btnModal:s,closeModal:a,saveModalData:d}},methods:{submitForm(){this.$refs.refTaskForm.validate(e=>{if(e)this.resetForm();else return})},resetForm(){this.$refs.refTaskForm.resetFields(),this.$refs.refTaskForm.clearValidate()}}},at={class:"my-header"},nt={class:"header-popup"};function rt(e,t,l,s,a,d){const r=U,f=q,M=j,g=L,_=S;return n(),k(_,{modelValue:s.isOpenModalEdit,"onUpdate:modelValue":t[4]||(t[4]=u=>s.isOpenModalEdit=u),width:"50%",onClose:t[5]||(t[5]=u=>(s.closeModal,d.resetForm()))},{header:i(()=>[D("div",at,[D("h4",nt,p(s.titleModal),1)])]),footer:i(()=>[D("div",null,[o(g,{onClick:t[2]||(t[2]=u=>(s.closeModal(),d.resetForm()))},{default:i(()=>[c("Отмена")]),_:1}),o(g,{type:"primary",onClick:t[3]||(t[3]=u=>(s.saveModalData(a.taskForm),d.submitForm()))},{default:i(()=>[c(p(s.btnModal),1)]),_:1})])]),default:i(()=>[o(M,{ref:"refTaskForm",model:a.taskForm,rules:a.rulesTask},{default:i(()=>[o(f,{class:"form-label",label:"Название",prop:"title"},{default:i(()=>[o(r,{modelValue:a.taskForm.title,"onUpdate:modelValue":t[0]||(t[0]=u=>a.taskForm.title=u),placeholder:"Введите название задачи",clearable:""},null,8,["modelValue"])]),_:1}),o(f,{class:"form-label",label:"Описание",prop:"description"},{default:i(()=>[o(r,{modelValue:a.taskForm.description,"onUpdate:modelValue":t[1]||(t[1]=u=>a.taskForm.description=u),rows:3,type:"textarea",placeholder:"Введите описание задачи",autofocus:!1},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}const G=E(lt,[["render",rt]]),dt={name:"TaskItem",props:{task:Number,taskInfo:Object},setup(){const e=x(),{tasksItems:t}=C(e),{openModal:l,deleteTask:s,statusEditableTitle:a,statusEditableDesc:d,statusDone:r}=e;return{tasksItems:t,openModal:l,deleteTask:s,statusEditableTitle:a,statusEditableDesc:d,statusDone:r}},directives:{focus:{inserted(e){e.focus()}}},data(){return{taskId:this.task,taskForm:{title:this.taskInfo.title,description:this.taskInfo.description,isDone:this.taskInfo.isDone,editableTitle:this.editableTitle,editableDesc:this.editableDesc},rulesTask:{title:[{required:!0,message:"Название задачи не может быть пустым.",trigger:"blur"},{min:3,message:"Минимальное количество символов: 3.",trigger:"blur"}],description:[{required:!0,message:"Описание задачи не может быть пустым.",trigger:"blur"},{min:3,message:"Минимальное количество символов: 3.",trigger:"blur"}]}}}},ct={class:"task__btns"};function ut(e,t,l,s,a,d){const r=Q,f=H,M=U,g=z,_=W,u=q,T=N("Notification"),m=R,V=N("Delete"),A=P,O=j,I=X,b=Z("focus");return n(),k(I,{class:"task",modelValue:a.taskId,"onUpdate:modelValue":t[10]||(t[10]=h=>a.taskId=h)},{default:i(()=>[o(A,{class:"task__content"},{default:i(()=>[o(f,{span:1,style:{"max-width":"20px"}},{default:i(()=>[o(r,{modelValue:a.taskForm.isDone,"onUpdate:modelValue":t[0]||(t[0]=h=>a.taskForm.isDone=h),onChange:t[1]||(t[1]=h=>s.statusDone(l.task)),class:"task__check"},null,8,["modelValue"])]),_:1}),o(f,{span:23},{default:i(()=>[o(O,{ref:"refTask",model:a.taskForm,rules:a.rulesTask},{default:i(()=>[o(A,null,{default:i(()=>[o(u,{prop:"title",class:"task__edit"},{default:i(()=>[s.tasksItems[l.task].editableTitle?B((n(),k(M,{key:0,modelValue:a.taskForm.title,"onUpdate:modelValue":t[2]||(t[2]=h=>a.taskForm.title=h),class:"task-name-edit",onBlur:t[3]||(t[3]=h=>s.statusEditableTitle(l.task,a.taskForm.title)),clearable:"",minlength:3},null,8,["modelValue"])),[[b]]):y("",!0),o(_,{placement:"bottom",width:250,trigger:"hover",content:"Нажмите, чтобы отредактировать."},{reference:i(()=>[s.tasksItems[l.task].editableTitle?y("",!0):(n(),k(g,{key:0,style:{"font-weight":"600",cursor:"pointer"},onClick:t[4]||(t[4]=h=>s.statusEditableTitle(l.task))},{default:i(()=>[c(p(a.taskForm.title),1)]),_:1}))]),_:1})]),_:1}),D("div",ct,[o(_,{placement:"bottom",width:95,trigger:"hover",content:"Просмотр"},{reference:i(()=>[o(m,{class:"task__btn",size:18},{default:i(()=>[o(T,{onClick:t[5]||(t[5]=h=>s.openModal("look",l.task))})]),_:1})]),_:1}),o(_,{placement:"bottom",width:80,trigger:"hover",content:"Удалить"},{reference:i(()=>[o(m,{class:"task__btn",size:18,onClick:t[6]||(t[6]=h=>s.deleteTask(s.tasksItems,l.task))},{default:i(()=>[o(V)]),_:1})]),_:1})])]),_:1}),o(u,{prop:"description",class:"task__edit"},{default:i(()=>[s.tasksItems[l.task].editableDesc?B((n(),k(M,{key:0,type:"textarea",modelValue:a.taskForm.description,"onUpdate:modelValue":t[7]||(t[7]=h=>a.taskForm.description=h),class:"task-name-edit",onBlur:t[8]||(t[8]=h=>s.statusEditableDesc(l.task,a.taskForm.description))},null,8,["modelValue"])),[[b]]):y("",!0),o(_,{placement:"bottom",width:250,trigger:"hover",content:"Нажмите, чтобы отредактировать."},{reference:i(()=>[s.tasksItems[l.task].editableDesc?y("",!0):(n(),k(g,{key:0,onClick:t[9]||(t[9]=h=>s.statusEditableDesc(l.task)),style:{cursor:"pointer"}},{default:i(()=>[c(p(s.tasksItems[l.task].description),1)]),_:1}))]),_:1})]),_:1})]),_:1},8,["model","rules"]),o(A,{style:{display:"flex","justify-content":"end"}},{default:i(()=>[s.tasksItems[l.task].updateAt.length==0?(n(),k(g,{key:0,style:{cursor:"default"}},{default:i(()=>[c("Создано: "+p(s.tasksItems[l.task].createAt),1)]),_:1})):(n(),k(g,{key:1,style:{cursor:"default"}},{default:i(()=>{var h;return[c("Обновлено: "+p(s.tasksItems[l.task].updateAt[((h=s.tasksItems[l.task].updateAt)==null?void 0:h.length)-1].dateChange),1)]}),_:1}))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}const J=E(dt,[["render",ut]]),mt={name:"HomeView",components:{TaskItem:J,AddModalTask:G,LookModalTask:Y},setup(){const e=x(),{tasksItems:t,activeModalValue:l,searchTaskParams:s,filteredTaskItems:a}=C(e),{filteredTask:d,openModal:r}=e;return{tasksItems:t,activeModalValue:l,searchTaskParams:s,filteredTaskItems:a,filteredTask:d,openModal:r}},data(){return{searchTask:""}}},ht={class:"main"},kt={key:0},ft={key:1};function _t(e,t,l,s,a,d){const r=N("Plus"),f=R,M=L,g=P,_=U,u=J,T=z,m=H,V=$,A=G,O=Y;return n(),v("main",ht,[o(g,{class:"header-task-container"},{default:i(()=>[o(M,{class:"header-task-container__btn",type:"success",onClick:t[0]||(t[0]=I=>s.openModal("add",!1))},{default:i(()=>[o(f,{class:"el-icon--left"},{default:i(()=>[o(r)]),_:1}),c(" Добавить задачу ")]),_:1})]),_:1}),o(V,{height:"calc(100vh - 140px)"},{default:i(()=>[o(m,{class:"task-container"},{default:i(()=>[o(_,{modelValue:a.searchTask,"onUpdate:modelValue":t[1]||(t[1]=I=>a.searchTask=I),placeholder:"Введите ключевое слово для поиска по задачам","prefix-icon":"Search",clearable:"",onInput:t[2]||(t[2]=I=>s.filteredTask(a.searchTask)),autofocus:""},null,8,["modelValue"]),a.searchTask==""?(n(),v("div",kt,[(n(!0),v(w,null,F(s.tasksItems,(I,b)=>(n(),k(u,{key:b,task:b,"task-info":I},null,8,["task","task-info"]))),128))])):y("",!0),a.searchTask!==""?(n(),v("div",ft,[(n(!0),v(w,null,F(s.filteredTaskItems,(I,b)=>(n(),k(u,{key:I,task:b,"task-info":I},null,8,["task","task-info"]))),128))])):y("",!0),s.tasksItems.length==0&&s.filteredTaskItems.length==0?(n(),k(T,{key:2},{default:i(()=>[c("Задачи отсутствуют.")]),_:1})):y("",!0),s.filteredTaskItems.length==0&&a.searchTask!==""?(n(),k(T,{key:3},{default:i(()=>[c("Задачи не найдены. Измените поисковый запрос и повторите попытку.")]),_:1})):y("",!0)]),_:1})]),_:1}),o(A,{ref:"refAddModalTask"},null,512),o(O,{ref:"refModalTask",modalValue:s.activeModalValue},null,8,["modalValue"])])}const It=E(mt,[["render",_t]]);export{It as default};
